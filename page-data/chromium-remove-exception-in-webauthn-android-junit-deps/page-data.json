{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/chromium-remove-exception-in-webauthn-android-junit-deps","result":{"data":{"markdownRemark":{"id":"2956e596-1c1f-5f09-aff3-43adb3a77f1f","html":"<h3 id=\"관련-링크\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A0%A8-%EB%A7%81%ED%81%AC\" aria-label=\"관련 링크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관련 링크</h3>\n<ul>\n<li>제목: webauthn: Remove java tests DEPS exceptions for ClientDataJsonImpl</li>\n<li>패치: <a href=\"https://chromium-review.googlesource.com/c/chromium/src/+/4622851\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://chromium-review.googlesource.com/c/chromium/src/+/4622851</a></li>\n<li>버그\n<ul>\n<li><a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=1445544\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://bugs.chromium.org/p/chromium/issues/detail?id=1445544</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h3>\n<p>Chromium 프로젝트의 content 모듈은 사실상 웹 브라우저의 본체와 같다. content 모듈에서 Chrome 의 자체 기능을 구현하거나 UI 를 활용한 부분을 제외한 전반적인 멀티프로세스 브라우저 기능을 담당한다. content 레이어까지만 포함하여 기본적인 브라우저 기능을 제공하는 Content Shell 이라는 앱을 빌드할 수도 있다. chrome 이나 android_webview 등의 content 를 사용하는 모듈은 content/public 폴더에 있는 public API 를 통해 content 모듈에 접근하도록 설계되어있다. Android 를 위한 Java 파일의 경우 content_public 과 같은 package 명으로 구분을 하기도 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 651px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a70aa0c5dcb25d48306256ff0a36ebf6/1ac66/content-layer-diagram.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACf0lEQVQ4y3VU2Y6jMBDk/79o3vZp31YrrTQTcpIQkszkhByAjTE1qoZmSKS1ZNm03UVVHw6KokCe51gulwjDELPZDHEcyzqfz2VGUYTxeCx2rrRNJhMkSYKqqnC73WCMAUeggLvdDufzGZfLBVmW9fvT6SQrv4eTdt67Xq8gBoEFkMhlWeLxeMjKb+ccvPcy6XC/32GtlW8O7jmbphHQuq5lL4BEpoG0+ScCUv50OhXZ2+1WzpUJ7ylL7tM0FXAOggogJ2WTCZ1+JKc4HA7C3hgr99brNZJkg9VqJT+jD5U9MVQJnGQzHLWjAtd9tU7e12g6+VSkCekZEohGawyqyqGsPHLTrpfsgUfpUDdAaX1ru+ZiL4oSWZqK7D7LQ8DKWhTGYvbl8LF1CHcO/1Y5fv1Z4e13iL+LG8LPGh8bi/fEYBatsY5jRNFSst4DCrtOcuVqfJ4LJMccx7vH7lxisblgnpywzyocrrXM+OsO3wDOVX3J9JIZVGXK+DBurmolOGvga4fGP8fWlLnEm75M5FNSaGTtaQm1+zYRPLO2/RldfNPA+wZl2dar1jEBhSGNWtQsHf0r9wqopfXE0BgpdA2ZDgFka5E2s8UWJBiLVhlIbDslnLy33++lVnmftapMRTK7gM4sUjY8D7U/+2R1xU+nxWIhDwY7aTQaSbFTGf2Dn2S0vUsHHmp/Sjl1klWeSiUJdpUqoT14jQ+Z6VBAZTiMn9qPx6P4EJShCDS7OsjwNfg8Z+K40onxpQIC8o1kyDjY3/Ieah3pqzN8jhgXfqtE/kBjqUyVrcSQMdD3Tl8aXiAws6d9+upMQH0fhyN4fV10sJSYzf+dazI11lrY3+bEDGi96fuIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a70aa0c5dcb25d48306256ff0a36ebf6/8ac56/content-layer-diagram.webp 240w,\n/static/a70aa0c5dcb25d48306256ff0a36ebf6/d3be9/content-layer-diagram.webp 480w,\n/static/a70aa0c5dcb25d48306256ff0a36ebf6/be1d0/content-layer-diagram.webp 651w\"\n              sizes=\"(max-width: 651px) 100vw, 651px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a70aa0c5dcb25d48306256ff0a36ebf6/8ff5a/content-layer-diagram.png 240w,\n/static/a70aa0c5dcb25d48306256ff0a36ebf6/e85cb/content-layer-diagram.png 480w,\n/static/a70aa0c5dcb25d48306256ff0a36ebf6/1ac66/content-layer-diagram.png 651w\"\n            sizes=\"(max-width: 651px) 100vw, 651px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a70aa0c5dcb25d48306256ff0a36ebf6/1ac66/content-layer-diagram.png\"\n            alt=\"content layer diagram\"\n            title=\"content layer diagram\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ul>\n<li>출처: <a href=\"https://chromium.googlesource.com/chromium/src/+/HEAD/content/README.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://chromium.googlesource.com/chromium/src/+/HEAD/content/README.md</a></li>\n<li>참고: <a href=\"https://chromium.googlesource.com/chromium/src/+/HEAD/content/public/README.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://chromium.googlesource.com/chromium/src/+/HEAD/content/public/README.md</a></li>\n</ul>\n<p>이런 각 레이어, 모듈 간의 종속성은 폴더마다 DEPS 파일로 관리한다. 이 파일에 선언한 내용을 위반하면 빌드가 불가능하다. 테스트나 어쩔 수 없는 특별한 경우에는 예외 처리를 하기도 한다.</p>\n<h3 id=\"내용\" style=\"position:relative;\"><a href=\"#%EB%82%B4%EC%9A%A9\" aria-label=\"내용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>내용</h3>\n<p>webauthn 의 안드로이드 테스트 코드에서 content 에 구현되어있는 <code class=\"language-text\">ClientDataJsonImpl</code> 클래스를 mocking 하여 사용하는 경우가 있다. 원칙적으로 <code class=\"language-text\">ClientDataJson</code> 클래스는 public 이고 ClientDataJsonImpl 은 그 구현체이기 때문에 chrome 레이어에서는 <code class=\"language-text\">ClientDataJson</code> 을 사용하고 <code class=\"language-text\">ClientDataJsonImpl</code> 에는 접근을 하면 안 된다. 하지만 테스트 코드에서는 <code class=\"language-text\">ClientDataJsonImpl</code> 을 예외처리하여 직접 사용하고 있다.</p>\n<ul>\n<li><code class=\"language-text\">ClientDataJson</code> 의 위치 : content/public/android/java/src/org/chromium/content_public/browser/ClientDataJson.java</li>\n<li><code class=\"language-text\">ClinetDataJsonImpl</code> 의 위치 : content/public/android/java/src/org/chromium/content/browser/ClientDataJsonImpl.java</li>\n</ul>\n<p>chrome/android/junit/DEPS 파일에는 <code class=\"language-text\">ClientDataJsonImpl</code> 파일에 대한 예외 처리가 되어있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">specific_include_rules = {\n  # Added to allow tests to mock JNI methods within the implementation. Tests\n  # use the public API classes where possible.\n  \"Fido2CredentialRequestRobolectricTest.java\": [\n    \"+content/public/android/java/src/org/chromium/content/browser/ClientDataJsonImpl.java\",\n  ]\n}</code></pre></div>\n<p>이처럼 DEPS 에 예외처리가 되어있고 <code class=\"language-text\">Fido2CredentialRequestRobolectricTest</code> 에서 <code class=\"language-text\">ClientDataJsonImpl</code> 을 import 하고 있지만 실제로는 사용하지 않고 있기 때문에 불필요한 코드를 삭제하고 DEPS 에서도 삭제했다.</p>\n<h3 id=\"후기\" style=\"position:relative;\"><a href=\"#%ED%9B%84%EA%B8%B0\" aria-label=\"후기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>후기</h3>\n<p>Chrome Android instrumentation 테스트를 하는 javatest 모듈에도 예외처리가 되어있다. (위치: chrome/android/javatests/DEPS) 여기서는 실제로 테스트 코드에서 <code class=\"language-text\">ClientDataJsonImpl</code> 를 사용하고 있어 DEPS 내 예외처리 삭제와 레이어 종속성 규칙을 지키기 위한 코드 수정이 함께 필요하다. 이전에 시도를 해보다가 적절한 답을 못 찾았는데 다음에 다시 한 번 도전해볼 생각이다.</p>","fields":{"slug":"/posts/2023-11-29---chromium-remove-exception-in-webauthn-android-junit-deps//chromium-remove-exception-in-webauthn-android-junit-deps","tagSlugs":["/tag/opensource/","/tag/chromium/","/tag/webauthn/"]},"frontmatter":{"date":"2023-11-29T07:00:00.000Z","description":"2023년 Chromium 에 반영한 네 번째 패치 내용 정리","tags":["opensource","chromium","webauthn"],"title":"Chromium Contribution: webauthn junit 사용하지 않는 코드 및 DEPS 삭제","socialImage":null}}},"pageContext":{"slug":"/posts/2023-11-29---chromium-remove-exception-in-webauthn-android-junit-deps//chromium-remove-exception-in-webauthn-android-junit-deps"}},"staticQueryHashes":["251939775","2702970128","401334301"]}